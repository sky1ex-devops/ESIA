# Инструкция по настройке ЕСИА Шлюза

## Конфигурация

### Конфигурирование хост-машины

Для запуска `ЕСИА Шлюз` можно использовать современную ОС семейства Linux. Тем не менее есть примерные требования, которые гарантируют нормальную работу и простоту запуска, поскольку они используются при разработке и тестировании платформы.

- ОС: Debian 9.5 (x86-64) или выше, Ubuntu 18.04 (x86-64) или выше;
- Наличие на машине доступа к harbor.rnds.pro, hub.docker.com по протоколу HTTPS на порт 443 для скачивания Docker образов сервисов;

-----

### Конфигурирование сервиса

Конфигурирование сервиса выполняется путем изменения файла `esia_gate/.env`

## Конфигурирование переменных окружения через `esia_gate/.env`

Для настройки переменных окружения ЕСИА Шлюза необходимо перейти к файлу [esia_gate/.env](.env)

`SENTINEL_IMAGE` и `SENTINEL_IMAGE_TAG` - значения Docker образа для ЕСИА Шлюза (по-умолчанию *harbor.rnds.pro/sentinel/sentinel-ror:box2.32*)

`ESIA_GATE_URI` - URI адрес тенанта ЕСИА Шлюза (по-умолчанию *https://esia.example.com*) 

Настройки БД для тенанта ЕСИА Шлюза (по-умолчанию стоят следующие значения):
`DATABASE_HOST`="db"  
`DATABASE_NAME`="main_esia_db"
`DATABASE_USER`="postgres"  
`DATABASE_PASS`="0QPnk5dVcAEg"  
`DATABASE_PORT`="5432" 

`SIGNER_IP`, `DATABASE_IP` и `REDIS_IP` - IP адреса инстансов для сервисов, с которыми взаимодействует (Сайнер, БД, Redis).

`MAIN_ADMIN_PASSWORD` - Пароль к главной учетной записи ЕСИА Шлюза. **Логин** - ***admin@esia.pro***

`SMTP_USER_NAME`, `SMTP_PORT`, `SMTP_PASSWORD` и `SMTP_ADDRESS` - настройки доступа к вашему почтовому серверу.

-----

## Запуск приложения

Запуск ЕСИА Шлюз производится с помощью скрипта `box_run.sh` вместе с Сайнером и прочим необходимым ПО. Процесс запуска описан в [Инструкции по подготовке и запуску коробочного решения](../README.md)